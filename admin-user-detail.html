<!doctype html>
<html lang="en">

<head>
    <title>Shadow-Dev</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="shortcut icon" href="asset/favicon.ico">
    <!-- iOS -->
    <link rel="apple-touch-icon-precomposed" href="asset/app.bg.png">
    <!-- Android -->
    <link rel="shortcut icon" href="asset/app.png">
    <link rel="icon" sizes="512x512" href="asset/app.png">
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap core CSS     -->
    <link rel="stylesheet" href="asset/css/bootstrap.min.css">
    <!-- Bootstrap Align -->
    <link rel="stylesheet" href="asset/css/bootstrap-align.css">
    <!-- Material Dashboard CSS    -->
    <link rel="stylesheet" href="asset/css/material-dashboard.css">
    <!-- Messg -->
    <link rel="stylesheet" href="asset/css/messg.min.css">
    <!-- App CSS    -->
    <link rel="stylesheet" href="asset/css/app.css">
    <!-- Fonts and icons     -->
    <link rel="stylesheet" href="asset/css/font-awesome.min.css">
</head>

<body>
    <div class="wrapper">
        <div class="sidebar" data-color="blue">
            <div class="logo">
                <a href="#" class="simple-text">
                    Shadow-Dev                </a>
            </div>
            <div class="sidebar-wrapper">
                <ul class="nav">
                    <li>
                        <a href="index.html">
                            <i class="fa fa-dashboard material-icons"></i>
                            <p>用户中心</p>
                        </a>
                    </li>
                    <li>
                        <a href="node.html">
                            <i class="fa fa-server material-icons"></i>
                            <p>节点列表</p>
                        </a>
                    </li>
                    <li>
                        <a href="user.html">
                            <i class="fa fa-user material-icons"></i>
                            <p>用户信息</p>
                        </a>
                    </li>
                    <li>
                        <a href="log.html">
                            <i class="fa fa-bar-chart material-icons"></i>
                            <p>流量日志</p>
                        </a>
                    </li>
                    <li>
                        <a href="invite.html">
                            <i class="fa fa-users material-icons"></i>
                            <p>邀请好友</p>
                        </a>
                    </li>
                    <li class="break-line"></li>
                    <li>
                        <a href="admin-node.html">
                            <i class="fa fa-server material-icons"></i>
                            <p>节点列表</p>
                        </a>
                    </li>
                    <li>
                        <a href="admin-user.html">
                            <i class="fa fa-user material-icons"></i>
                            <p>用户列表</p>
                        </a>
                    </li>
                    <li>
                        <a href="admin-log.html">
                            <i class="fa fa-bar-chart material-icons"></i>
                            <p>流量日志</p>
                        </a>
                    </li>
                    <li>
                        <a href="system.html">
                            <i class="fa fa-info-circle material-icons"></i>
                            <p>系统信息</p>
                        </a>
                    </li>
                    <li class="break-line"></li>
                    <li>
                        <a href="#">
                            <i class="fa fa-sign-out material-icons"></i>
                            <p>退出</p>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="main-panel">
            <nav class="navbar navbar-transparent navbar-absolute">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse">
                        <i class="fa fa-bars" aria-hidden="true"></i>
                    </button>
                        <span class="navbar-brand">用户详情</span>
                    </div>
                </div>
            </nav>
            <div class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="card">
                                <div class="card-header" data-background-color>
                                    <h4 class="title">用户详情</h4>
                                </div>
                                <div class="card-content">
                                    <form id="form-user">
                                        <div>
                                            <div class="form-group">
                                                <label class="control-label">用户名</label>
                                                <span class="form-control">ouye</span>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label">邮箱</label>
                                                <span class="form-control">user@mail.com</span>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label">端口</label>
                                                <span class="form-control">1234</span>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label">可用邀请码</label>
                                                <span class="form-control">0</span>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label">邀请人</label>
                                                <span class="form-control">无</span>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label">注册时间</label>
                                                <span class="form-control">2000-01-01 00:00:00</span>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label">注册IP</label>
                                                <span class="form-control">0.0.0.0 [IANA 保留地址]</span>
                                            </div>
                                        </div>
                                        <div>
                                            <a href="?uid=1&edit" class="btn btn-primary">编辑</a>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="card">
                                <div class="card-header" data-background-color>
                                    <h4 class="title">流量使用</h4>
                                </div>
                                <div class="card-content">
                                    <div>
                                        <div class="form-group">
                                            <label class="control-label">连接密码</label>
                                            <span class="form-control">1234567</span>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label">流量</label>
                                            <span class="form-control">1000 GB</span>
                                        </div>
                                        <div class="form-group">
                                            <div class="progress-usage">
                                                <div class="progress" data-toggle="tooltip" title='970.92 GB / 29.08 GB / 1000 GB'>
                                                    <div class="progress-bar progress-bar-primary" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 2.9080183980055%"> <span class="sr-only">Transfer</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label">限速</label>
                                            <span class="form-control" id="max-speed">0</span>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label">最后使用时间</label>
                                            <span class="form-control">2017-10-05 21:28:55</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="card">
                                <div class="card-header" data-background-color>
                                    <h4 class="title">添加流量</h4>
                                </div>
                                <div class="card-content">
                                    <form id="form-transfer">
                                        <div class="form-group">
                                            <label class="control-label">流量(GByte)</label>
                                            <input class="form-control " id="transfer" required="required" placeholder="小于0则扣除流量">
                                        </div>
                                        <button type="submit" id="user-addtransfer" class="btn btn-success">确定</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="card">
                                <div class="card-header" data-background-color>
                                    <h4 class="title">添加邀请码</h4>
                                </div>
                                <div class="card-content">
                                    <form id="form-invitenum">
                                        <div class="form-group">
                                            <label class="control-label">数量</label>
                                            <input class="form-control" id="invitenum" required="required" placeholder="小于0则减少邀请码数量">
                                        </div>
                                        <button type="submit" id="user-addinvitenum" class="btn btn-success">确定</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="card">
                                <div class="card-header" data-background-color>
                                    <h4 class="title">流量图表 - 30 Days</h4>
                                </div>
                                <div class="card-content">
                                    <div class="usage-box"><canvas width="16px" height="9px" class="usage-month"></canvas></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="card">
                                <div class="card-header" data-background-color>
                                    <h4 class="title">流量图表 - 24 Hours</h4>
                                </div>
                                <div class="card-content">
                                    <div class="usage-box"><canvas width="16px" height="9px" class="usage-day"></canvas></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <footer class="footer">
                <div class="container-fluid">
                    <p class="copyright pull-right">
                        <span class="visible-sm-inline-block visible-md-inline-block visible-lg-inline-block"><strong>Copyright &copy; 2014-2017 <a href="#">Shadow-Dev</a> </strong> All rights reserved.</span>
                        <span class="visible-xs-inline-block visible-sm-inline-block visible-md-inline-block visible-lg-inline-block">Powered by <b>ShadowX</b> 1.1.0 <a href="tos.html" target="_tos">服务条款</a></span>
                    </p>
                </div>
            </footer>
        </div>
    </div>
</body>

<!--   Core JS Files   -->
<script src="asset/js/jquery.min.js" type="text/javascript"></script>
<script src="asset/js/bootstrap.min.js" type="text/javascript"></script>
<script src="asset/js/material.min.js" type="text/javascript"></script>
<!-- jQuery Cookit 1.4.1 -->
<script src="asset/js/jquery.cookie.min.js"></script>
<!--  Dynamic Elements plugin -->
<script src="asset/js/arrive.min.js"></script>
<!-- Material Dashboard javascript methods -->
<script src="asset/js/material-dashboard.js"></script>
<!-- Messg -->
<script src="asset/js/messg.min.js"></script>
<!-- Moment 2.18.1 -->
<script src="asset/js/moment.min.js"></script>
<!-- App -->
<script src="asset/js/app.js"></script>

</html>
<!-- Chart 2.6.0 -->
<script src="asset/js/Chart.bundle.min.js"></script>
<!-- Bootstrap Slider 9.8.1 -->
<link rel="stylesheet" href="asset/css/bootstrap-slider.min.css">
<script src="asset/js/bootstrap-slider.min.js"></script>

<script>
    var speeds = [{
        value: 512,
        label: "512 Kbps"
    }, {
        value: 1024,
        label: "1 Mbps"
    }, {
        value: 2048,
        label: "2 Mbps"
    }, {
        value: 4096,
        label: "4 Mbps"
    }, {
        value: 8192,
        label: "8 Mbps"
    }, {
        value: 0,
        label: "不限速"
    }];

    function getSpeed(value) {
        var result = {};
        $.each(speeds, function(index, item) {
            if (value === item.value) {
                result.index = index;
                result.value = item.value;
                result.label = item.label;
            }
        });
        return result;
    }
    var uid = 1;

    !(function() {
        var interval = 3600 * 24;

        var to = 1505691600;
        var from = to - 3600 * 24 * 30;

        $(".usage-month").each(function() {
            var elem = this;
            $.ajax({
                url: "ajax/getLogRange.json",
                cache: false,
                type: "GET",
                data: {
                    action: "getLogRange",
                    from: from,
                    to: to + interval - 1,
                    uid: uid,
                    type: "days"
                }
            }).done(function(data) {

                showChart(elem, from, to, interval, data.data);
            });
        });
    })();

    !(function() {
        var interval = 1200;

        var to = 1505691600;
        var from = to - 3600 * 24;

        $(".usage-day").each(function() {
            var elem = this;
            $.ajax({
                url: "ajax/getLogRange.json",
                cache: false,
                type: "GET",
                data: {
                    action: "getLogRange",
                    from: from,
                    to: to + interval - 1,
                    uid: uid,
                    type: "20min"
                }
            }).done(function(data) {

                showChart(elem, from, to, interval, data.data);
            });
        });
    })();

    !(function() {
        function addTransfer(transfer) {
            $.ajax({
                type: "GET",
                url: "ajax/ok.json",
                dataType: "json",
                data: {
                    action: "addtransfer",
                    uid: uid,
                    transfer: transfer * 1024 * 1024 * 1024
                },
                success: function(data) {
                    if (data.ok) {
                        new Message("操作成功", "success", 1000);
                        setTimeout(function() {
                            location.href = "admin-user-detail.html?uid=" + uid;
                        }, 1000);
                    } else {
                        new Message(data.msg, "error", 1000);
                        $("#user-addtransfer").attr("disabled", false);
                    }
                },
                error: function(jqXHR) {
                    new Message("发生错误：" + jqXHR.status, "error", 1000);
                    $("#user-addtransfer").attr("disabled", false);
                }
            });
        }

        $("#form-transfer").submit(function() {
            var transfer = parseInt($("#transfer").val());
            if (transfer > 0 || transfer < 0) {
                $("#user-addtransfer").attr("disabled", true);
                addTransfer(transfer);
            }
            return false;
        });
    })();

    !(function() {
        function addInviteNum(num) {
            $.ajax({
                type: "GET",
                url: "ajax/ok.json",
                dataType: "json",
                data: {
                    action: "addinvitenum",
                    uid: uid,
                    num: num
                },
                success: function(data) {
                    if (data.ok) {
                        new Message("操作成功", "success", 1000);
                        setTimeout(function() {
                            location.href = "admin-user-detail.html?uid=" + uid;
                        }, 1000);
                    } else {
                        new Message(data.msg, "error", 1000);
                        $("#user-addinvitenum").attr("disabled", false);
                    }
                },
                error: function(jqXHR) {
                    new Message("发生错误：" + jqXHR.status, "error", 1000);
                    $("#user-addinvitenum").attr("disabled", false);
                }
            });
        }

        $("#form-invitenum").submit(function() {
            var num = parseInt($("#invitenum").val());
            if (num > 0 || num < 0) {
                $("#user-addinvitenum").attr("disabled", true);
                addInviteNum(num);
            }
            return false;
        });

        !(function() {
            var speed = getSpeed(parseInt($("#max-speed").text()));
            $("#max-speed").text(speed.label);
        })();
    })();
</script>